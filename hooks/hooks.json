{
  "description": "TDD workflow hooks: enforces R-G-R cycle completion and prevents premature session end",
  "hooks": {
    "SubagentStop": [
      {
        "matcher": "tdd-implementer",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "The tdd-implementer has finished a slice. Evaluate: $ARGUMENTS\n\nCheck if:\n1. A failing test was written and confirmed RED\n2. Implementation was written and confirmed GREEN\n3. Refactoring was done (or explicitly skipped) and confirmed still GREEN\n4. All three phases were completed with test output\n\nIf incomplete, respond {\"ok\": false, \"reason\": \"Incomplete R-G-R cycle: [missing step]\"}.\nIf complete, respond {\"ok\": true}.",
            "timeout": 30
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Check if a TDD session is in progress by looking for .tdd-progress.md. If it exists and there are slices with status PENDING or IN_PROGRESS, the session is NOT complete. Respond {\"ok\": false, \"reason\": \"TDD session has remaining slices\"} to continue. If all slices are PASS or no TDD session is active, respond {\"ok\": true}.",
            "timeout": 15
          }
        ]
      }
    ]
  }
}
